day_str <- format(vect, "%a")
time <- format(vect$stoptime,"%H:%M")
time <- as.POSIXct(strptime(vect,format="%H:%M"))
hr <- format(vect,"%H")
df <- data.frame(month=month,day=day,day_str=day_str,time=time,hr=hr)
return(df)
}
View(getDateComponents(trips85$stoptime))
getDateComponents <- function(vect){
print("Returns a separate dataframe that can be renamed and cbinded to input dataset")
month <- format(vect, "%m")
day <- format(vect, "%d")
day_str <- format(vect, "%a")
time <- format(vect,"%H:%M")
time <- as.POSIXct(strptime(vect,format="%H:%M"))
hr <- format(vect,"%H")
df <- data.frame(month=month,day=day,day_str=day_str,time=time,hr=hr)
return(df)
}
View(getDateComponents(trips85$stoptime))
stoptimes <- getDateComponents(trips85$stoptime)
colnames(stoptimes) <- c("stopMonth","stopDay","stopDay_str","stopTime","stopHr")
View(colnames)
View(stoptimes)
trips85 <- cbind(trips85,stoptimes)
View(trips85)
starttimes <- getDateComponents(trips85$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85 <- cbind(trips85,stoptimes,starttimes)
trips85 <- trips %.%
filter(to_station_id==85)%.%
arrange(stoptime)
trips85$diff <- c(NA,diff(trips85$stoptime))
stoptimes <- getDateComponents(trips85$stoptime)
colnames(stoptimes) <- c("stopMonth","stopDay","stopDay_str","stopTime","stopHr")
starttimes <- getDateComponents(trips85$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85 <- cbind(trips85,stoptimes,starttimes)
avgDiff <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day_str)+ggtitle("Latency of Bike Arrival at station 85")
colnames(trips85)
View(avgDiff)
ggplot(avgDiff,aes(x=as.integer(stopHr),y=meanDif))+geom_line()+facet_wrap(~ stopDay_str)+ggtitle("Latency of Bike Arrival at station 85")
avgDiff <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
avgDiffStop <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffStart <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
avgDiffStop$version <- "Stop"
avgDiffStart$version <- "Start"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
colnames(avgDiffStart)
avgDiffStart <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffStop <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
colnames(avgDiffStop) <- c("Day_str","Hr","meanDif")
avgDiffStop$version <- "Stop"
colnames(avgDiffStart) <- c("Day_str","Hr","meanDif")
avgDiffStart$version <- "Start"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
avgDiffStop$version <- "Arrival"
avgDiffStart$version <- "Departure"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif,color=version))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
View(trips85)
trips85D <- trips %.%
filter(from_station_id==85)%.%
arrange(starttime)
trips85D$diff <- c(NA,diff(trips85D$stoptime))
starttimes <- getDateComponents(trips85D$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85D <- cbind(trips85D,starttimes)
avgDiffStart <- ddply(trips85D,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiffStart,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
trips85D$diff <- c(NA,diff(trips85D$starttime))
starttimes <- getDateComponents(trips85D$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85D <- cbind(trips85D,starttimes)
avgDiffStart <- ddply(trips85D,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiffStart,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
colnames(avgDiffStart) <- c("Day_str","Hr","meanDif")
avgDiffStart$version <- "Departure"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif,color=version))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
trips <- trips %.%
arrange(to_station_id) %.%
arrange(tripstop)
colnames(trips)
trips <- trips %.%
arrange(to_station_id) %.%
arrange(stoptime)
View(trips)
trips <- trips %.%
arrange(to_station_id, stoptime)
View(trips)
testTrips <- ddply(trips,.(to_station_id),function(x) x$diff <- c(NA,diff(x$stoptime)))
testTrips <- ddply(trips,.(to_station_id),function(x) diff <- c(NA,diff(x$stoptime)))
testTrips <- ddply(trips,.(to_station_id),function(x) return(c(NA,diff(x$stoptime))))
fix <- function(x){
return(c(NA,diff(x$stoptime)))
}
testTrips <- ddply(trips,.(to_station_id),fix )
ddply(trips,.(to_station_id),fix )
fix <- function(x){
print(nrow(x))
return(c(NA,diff(x$stoptime)))
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
print(nrow(x))
diffs <- c(NA,diff(x$stoptime))
print(length(diffs))
return(diffs)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(diffs)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(x$diffs)
}
test <- ddply(trips,.(to_station_id),fix )
View(test)
fix <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(x)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
test <- ddply(trips,.(to_station_id),fix )
View(test)
doDiffsPanel <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
doDiffsPanel <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doDiffsPanel)
trips <- rename(trips, diffs="stopdiffs")
help(rename)
trips <- rename(trips, c(diffs="stopdiffs"))
colnames(trips)
doStopDiffsPanel <- function(x){
x$stopdiffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
doStartDiffsPanel <- function(x){
x$startdiffs <- c(NA,diff(x$starttime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
doStopDiffsPanel <- function(x){
x$stopdiffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$stopdiffs)){print("ERROR")}
return(x)
}
doStartDiffsPanel <- function(x){
x$startdiffs <- c(NA,diff(x$starttime))
if(nrow(x)!=length(x$startdiffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
trips <- ddply(trips,.(from_station_id),doStartDiffsPanel)
View(trips)
trips <- trips %.%
arrange(from_station_id, starttime)
trips <- ddply(trips,.(from_station_id),doStartDiffsPanel)
View(trips)
avgStartDiffs_all <- ddply(trips,.(from_station_id),summarize,
meanStartDiff=mean(startdiffs,na.rm=TRUE),
sdStartDiff = sd(starddiffs,na.rm=TRUE))
avgStartDiffs_all <- ddply(trips,.(from_station_id),summarize,
meanStartDiff=mean(startdiffs,na.rm=TRUE),
sdStartDiff = sd(startdiffs,na.rm=TRUE))
avgDiffs_all <- merge(avgStartDiffs_all,avgStopDiffs_all,by.x="from_station_id",by.y="to_station_id",all=TRUE)
avgStopDiffs_all <- ddply(trips,.(to_station_id),summarize,
meanStopDiff=mean(stopdiffs,na.rm=TRUE),
sdStopDiff=sd(stopdiffs,na.rm=TRUE))
avgDiffs_all <- merge(avgStartDiffs_all,avgStopDiffs_all,by.x="from_station_id",by.y="to_station_id",all=TRUE)
View(avgDiffs_all)
avgDiffs_all$avgDiff <- (avgDiffs_all$meanStartDiff+avgDiffs_all$meanStopDiff)/2
avgDiffs_all <- arrange(avgDiffs_all,avgDiff)
View(avgDiffs_all)
colnames(avgDiffs_all)
avgDiffs_all <- merge(stations,avgDiffs_all,by.x="id",by.y="from_station_id",all=TRUE)
avgDiffs_all <- arrange(avgDiffs_all,avgDiff)
View(avgDiffs_all)
cor(avgDiffs_all$meanStartdiff,avgDiffs_all$meanStopDiff)
cor(as.numeric(avgDiffs_all$meanStartdiff),as.numeric(avgDiffs_all$meanStopDiff))
cor(as.numeric(avgDiffs_all$meanStartDiff),as.numeric(avgDiffs_all$meanStopDiff))
avgDiffs_all[1:10,]
avgDiffs_all[1:10,c(2,5,6,9:13)]
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)*5))
test <- data.frame(x=c(1,2,3,4,5,6))
test$y <- 1-test$x
test
test$z <- abs(test$y)
test
test$y <- 1/test$x
test
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)*5))
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)))
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)))
temp < 1/avgDiffs_all$avgDiff
temp <- 1/avgDiffs_all$avgDiff
View(temp)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/avgDiffs_all$avgDiff)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/avgDiffs_all$avgDiff)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=*1/avgDiffs_all$avgDiff)*2)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*2)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*2)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*5)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*20)
temp <- 1/avgDiffs_all$avgDiff
View(temp)
max(temp)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*1000)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*10000)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier"),
latitude=c(41.7925006,41.8658049,41.8883247),
longitude=c(-87.5830209,-87.6329741,-87.6248812))
text(refPoints$longitude,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=2,col="red")
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier"),
latitude=c(41.7905733,41.8661567,41.8915194),
longitude=c(-87.5830607,-87.6170968,-87.6025343))
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=2,col="red")
text(refPoints$longitude,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.00001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.0001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude-.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.1,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.1,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
water <- makeLatLong("Waterways","Hydro")
plot(water,add=TRUE)
plot(water,add=TRUE,col="Blue")
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier","WrigleyField"),
latitude=c(41.7905733,41.8661567,41.8915194,41.9478307),
longitude=c(-87.5830607,-87.6170968,-87.6025343,-87.6559023))
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(water,add=TRUE,col="Blue",border="blue")
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.02,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude+.02,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude+.01,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.02,y=refPoints$latitude+.01,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude+.005,labels=refPoints$Location,cex=.5)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
help(over)
crime <- read.csv("Crimes_-_2013.csv",header=TRUE,stringsAsFactors=FALSE)
View(crime)
plot(city)
points(crime$X.Coordinate,crime$Y.Coordinate)
plot(city)
plot(city,axes=TRUE)
points(crime$X.Coordinate,crime$Y.Coordinate,pch=20)
points(crime$Y.Coordinate,crime$X.Coordinate,pch=20)
plot(crime$Y.Coordinate,crime$X.Coordinate,pch=20)
plot(city,axes=TRUE)
points(crime$Latitude,crime$Longitude,pch=20)
points(crime$Longitude,crime$Latitude,pch=20)
rm(crimes)
rm(crime)
library(sp)
over(draw,city)
temp <- over(neighborhoods,stations)
library(geos)
library(rgeos)
data(meuse.grid)
View(data)
View(meuse.grid)
plot(meuse.grid)
plot(meuse.grid$x,meuse.grid$y)
gridded(meuse.grid) = ~x+y
help(gridded)
gridded(meuse.grid)
data(meuse.grid)
gridded(meuse.grid)
vignette(gridded)
image(meuse.grid)
plot(meuse.grid$x,meuse.grid$y)
crimes <- read.csv("Crimes_-_2013.csv",header=TRUE,stringsAsFactors)
crimes <- read.csv("Crimes_-_2013.csv",header=TRUE,stringsAsFactors=TRUE)
colnames(crimes)
View(crimes)
help(floor)
crimes$Longitude <- round(crimes$Longitude,digits=3)
crimes$Latitude <- round(crimes$Latitude,digits=3)
library(plyr)
nCrimes <- count(crimes,.(latitude,longitude))
nCrimes <- count(crimes,.(Latitude,Longitude))
plot(nCrimes$Latitude,nCrimes$Longitude)
plot(nCrimes$Longitude,nCrimes$Latitude)
plot(nCrimes$Longitude,nCrimes$Latitude,pch=20)
plot(nCrimes$Longitude,nCrimes$Latitude,pch=20,cex=.1)
plot(nCrimes$Longitude,nCrimes$Latitude,pch=20,cex=.1,col=heat.colors(2))
crimes$Longitude <- round(crimes$Longitude,digits=2)
crimes$Latitude <- round(crimes$Latitude,digits=2)
nCrimes <- count(crimes,.(Latitude,Longitude))
plot(nCrimes$Longitude,nCrimes$Latitude,pch=20,cex=.1,col=heat.colors(2))
plot(nCrimes$Longitude,nCrimes$Latitude,pch=20,cex=1,col=heat.colors(2))
help(heat.colors)
plot(crimes)
View(nCrimes)
library(ggplot2)
ggplot(nCrimes,aes(x=Latitude,y=Longitude,color=freq))+geom_points()
ggplot(nCrimes,aes(x=Latitude,y=Longitude,color=freq))+geom_point()
ggplot(nCrimes,aes(x=Latitude,y=Longitude,colour=freq))+geom_point()
colnames(nCrimes)
ggplot(nCrimes,aes(x=Latitude,y=Longitude))+geom_point()
library(ggplot2)
ggplot(nCrimes,aes(x=Latitude,y=Longitude))+geom_point()
ggplot(nCrimes,aes(x=Latitude,y=Longitude))+geom_point(color=freq)
ggplot(nCrimes,aes(Latitude,Longitude))+geom_point(color=freq)
ggplot(nCrimes,aes(Latitude,Longitude))
dev.off()
dev.off()
ggplot(nCrimes,aes(Latitude,Longitude))
ggplot(nCrimes,aes(Latitude,Longitude))+geom_point()
ggplot(nCrimes,aes(Longitude,Latitude,color=freq))+geom_point()
crimes$Longitude <- round(crimes$Longitude,digits=1)
crimes$Latitude <- round(crimes$Latitude,digits=1)
nCrimes <- count(crimes,.(Latitude,Longitude))
ggplot(nCrimes,aes(Longitude,Latitude,color=freq))+geom_point()
crimes <- read.csv("Crimes_-_2013.csv",header=TRUE,stringsAsFactors=TRUE)
colnames(crimes)
crimes$Longitude <- round(crimes$Longitude,digits=2)
crimes$Latitude <- round(crimes$Latitude,digits=2)
nCrimes <- count(crimes,.(Latitude,Longitude))
ggplot(nCrimes,aes(Longitude,Latitude,color=freq))+geom_point()
ggplot(nCrimes,aes(Longitude,Latitude,size=freq))+geom_point()
stations <- read.csv("Divvy_Stations_2013.csv",header=TRUE,stringsAsFactors=FALSE)
nStations <- count(crimes,.(latitude,longitude))
stations$latitude <- round(stations$latitude,digits=2)
stations$longitude <- round(stations$longitude,digits=2)
View(stations)
nStations <- count(crimes,.(latitude,longitude))
nStations <- count(stations,.(latitude,longitude))
plot(nStations$longitude,nStations$latitude)
View(nstations)
View(nStations)
data <- merge(nStations,nCrimes,by.x=c("latitude","longitude"),by.y=c("Latitude","Longitude"),all=TRUE)
View(data)
data$freq.x[is.na(data$freq.x)]<-0
data$freq.y[is.na(data$freq.y)]<-1
cor(data$freq.x,data$freq.y)
plot(data$latitude,data$longitude)
plot(data$longitude,data$latitude)
plot(data$longitude,data$latitude,pch=20)
colnames(bLIc)
colnames(bLic)
bLic <- read.csv("Business_Licenses_-_Current_Active_-_Map.csv",header=TRUE,stringsAsFactors)
bLic <- read.csv("Business_Licenses_-_Current_Active_-_Map.csv",header=TRUE,stringsAsFactors=FALSE)
bLic$LATITUDE <- round(bLic$LATITUDE,digits=2)
bLic$LONGITUDE <- round(bLic$LONGITUDE,digits=2)
nBLic <- count(bLic,.(LATITUDE,LONGITUDE))
help(rename)
nBLic <- rename(nBLic, c("freq"="licFreq"))
View(nBLic)
data <- merge(data,nBLic,by.x=c("latitude","longitude"),by.y=c("LATITUDE","LONGITUDE"),all=TRUE)
data$licFreq[is.na(data$licFreq)] <- 0
View(data)
bLic <- read.csv("Business_Licenses_-_Current_Active_-_Map.csv",header=TRUE,stringsAsFactors=FALSE)
bLic$LATITUDE <- round(bLic$LATITUDE,digits=2)
bLic$LONGITUDE <- round(bLic$LONGITUDE,digits=2)
nBLic <- count(bLic,.(LATITUDE,LONGITUDE))
nBLic <- rename(nBLic, c("freq"="licFreq"))
stations <- read.csv("Divvy_Stations_2013.csv",header=TRUE,stringsAsFactors=FALSE)
stations$LATITUDE <- round(stations$latitude,digits=2)
stations$LONGITUDE <- round(stations$longitude,digits=2)
nStations <- count(stations,.(latitude,longitude))
crimes <- read.csv("Crimes_-_2013.csv",header=TRUE,stringsAsFactors=FALSE)
colnames(crimes)
crimes$LONGITUDE <- round(crimes$Longitude,digits=2)
crimes$LATITUDE <- round(crimes$Latitude,digits=2)
nCrimes <- count(crimes,.(Latitude,Longitude))
data <- merge(nStations,nCrimes,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data <- merge(data,nBLic,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data$freq.x[is.na(data$freq.x)]<-0
data$freq.y[is.na(data$freq.y)]<-0
data$licFreq[is.na(data$licFreq)] <- 0
nStations <- count(stations,.(LATITUDE,LONGITUDE))
nCrimes <- count(crimes,.(LATITUDE,LONGITUDE))
data <- merge(nStations,nCrimes,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data <- merge(data,nBLic,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data$freq.x[is.na(data$freq.x)]<-0
data$freq.y[is.na(data$freq.y)]<-0
data$licFreq[is.na(data$licFreq)] <- 0
cor(data$freq.x,data$freq.y,data$licFreq)
library(corrgram)
corrgram(data)
nStations <- rename(nStations,c("freq"="nStations"))
nCrimes <- rename(nCrimes,c("freq"="nCrimes"))
nStations <- rename(nStations,c("freq"="nStations"))
data <- merge(nStations,nCrimes,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data <- merge(data,nBLic,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data$nStations[is.na(data$nStations)]<-0
data$nCrimes[is.na(data$nCrimes)]<-0
data$licFreq[is.na(data$licFreq)] <- 0
corrgram(data)
corrgram(data,lower.panel=panel.pts)
corrgram(data,lower.panel=panel.pts,upper.panel=panel.pie)
View(bLic)
colnames(bLic)
nBLic <- count(bLic,.(LATITUDE,LONGITUDE,LICENCE.DESCRIPTION))
nBLic <- count(bLic,.(LATITUDE,LONGITUDE,LICENSE.DESCRIPTION))
nBLic <- rename(nBLic, c("freq"="licFreq"))
nBLic <- reshape(nBLic,idvar=c("LATITUDE","LONGITUDE"),timevar="LICENSE.DESCRIPTION",direction="wide")
View(nBLic)
categories <- count(bLic,.(LICENSE.DESCRIPTION))
write.table(categories,"BusinessLicenseKey.csv",sep=",",row.names=FALSE)
bLicKey <- read.csv("BusinessLicenseKey.csv",header=TRUE,stringsAsFactors=FALSE)
bLic <- merge(bLic,bLicKey,by=LICENSE.DESCRIPTION,all.x=TRUE)
bLic <- merge(bLic,bLicKey,by="LICENSE.DESCRIPTION",all.x=TRUE)
nBLic <- count(bLic,.(LATITUDE,LONGITUDE,LICENSE.TYPE))
bLicKey <- read.csv("BusinessLicenseKey.csv",header=TRUE,stringsAsFactors=FALSE)[c("LICENSE.DESCRIPTION","LICENSE.TYPE")]
bLic <- read.csv("Business_Licenses_-_Current_Active_-_Map.csv",header=TRUE,stringsAsFactors=FALSE)
bLicKey <- read.csv("BusinessLicenseKey.csv",header=TRUE,stringsAsFactors=FALSE)[c("LICENSE.DESCRIPTION","LICENSE.TYPE")]
bLic <- merge(bLic,bLicKey,by="LICENSE.DESCRIPTION",all.x=TRUE)
bLic$LATITUDE <- round(bLic$LATITUDE,digits=2)
bLic$LONGITUDE <- round(bLic$LONGITUDE,digits=2)
nBLic <- count(bLic,.(LATITUDE,LONGITUDE,LICENSE.TYPE))
nBLic <- rename(nBLic, c("freq"="licFreq"))
nBLic <- reshape(nBLic,idvar=c("LATITUDE","LONGITUDE"),timevar="LICENSE.DESCRIPTION",direction="wide")
nBLic <- reshape(nBLic,idvar=c("LATITUDE","LONGITUDE"),timevar="LICENSE.TYPE",direction="wide")
data <- merge(nStations,nCrimes,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data <- merge(data,nBLic,by=c("LATITUDE","LONGITUDE"),all=TRUE)
data$nStations[is.na(data$nStations)]<-0
data$nCrimes[is.na(data$nCrimes)]<-0
View(data)
data[is.na(data)] <- 0
View(data)
corrgram(data,lower.panel=panel.pts,upper.panel=panel.pie)
png("Corrgram.png",height=20,width=20,res=300,units="in")
corrgram(data,lower.panel=panel.pts,upper.panel=panel.pie)
dev.off()
