loopersMen$perWomen <- loopersMen$freq.Female/sum(loopersMen[,3:4])
loopersMen$perMan <- loopersMen$freq.Male/sum(loopersMen[,3:4])
View(loopersMen)
loopersMen$perWomen <- loopersMen$freq.Female/sum(loopersMen[1,3:4])
loopersMen$perMan <- loopersMen$freq.Male/sum(loopersMen[1,3:4])
View(loopersMen)
1721+5905
5905/7626
loopersMen$perWomen <- loopersMen$freq.Female/(loopersMen$freq.Female+loopersMen$freq.Male)
loopersMen$perMan <- loopersMen$freq.Male/(loopersMen$freq.Female+loopersMen$freq.Male)
View(loopersMen)
colnames(loopCount2)
loopCount2Wide <- reshape(loopCountWide,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysOnline",direction="wide")
loopCount2Wide <- reshape(loopCountWide,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysOnline"),direction="wide")
loopCount2Wide <- reshape(loopCount2,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysOnline"),direction="wide")
loopCount2Wide <- reshape(loopCount2,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysonline"),direction="wide")
test <- loopCount2$from_station_id
test <- loopCount2$name
test <- loopCount2$latitude
test <- loopCount2$longitude
test <- loopCount2$dpcapacity
test <- loopCount2$landmark
test <- loopCount2$online.date
colnames(loopCount2)
View(test)
test <- loopCount2$daysOnline
View(test)
loopCount2Wide <- reshape(loopCount2,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysOnline"),direction="wide")
loopCount2Wide <- reshape(loopCount2,idvar=c("from_station_id","name","latitude","longitude","dpcapacity","landmark","online.date","daysOnline"),timevar="loop",direction="wide")
View(loopCount2Wide)
colnames(loopCount2Wide)
loopCount2Wide$stationProbLoop <- (loopCount2Wide$freq.1/(loopCount2Wide$freq.1+loopCount2Wide$freq.0))*100
loopCount2Wide <- arrange(loopCount2Wide, -stationProbLoop)
View(loopCount2Wide)
colnames(loopCount2Wide)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(loopCount2Wide$longitude,loopCount2Wide$latitude,pch=20,cex=(loopCount2Wide$stationProbLoop*2)
points(loopCount2Wide$longitude,loopCount2Wide$latitude,pch=20,cex=(loopCount2Wide$stationProbLoop*2)
points(loopCount2Wide$longitude,loopCount2Wide$latitude,pch=20,cex=(loopCount2Wide$stationProbLoop/100))
png("HighestLoopProbability.png", height=10,width=10,res=300,units="in")
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(loopCount2Wide$longitude,loopCount2Wide$latitude,pch=20,cex=(loopCount2Wide$stationProbLoop/100))
dev.off()
loopers
colnames(trips)
trips85 <- trips %.%
filter(to_station_id==85)%.%
arrange(stoptime)
library(dplyr)
trips85 <- trips %.%
filter(to_station_id==85)%.%
arrange(stoptime)
View(trips85)
help(diffs)
help(diff)
trips85$diff <- diff(trips85$stoptime)
trips85$diff <- c(NA,diff(trips85$stoptime))
View(trips85)
hist(trips85$diff)
hist(trips85$diff, breaks=200)
avgDiff <- ddply(trips85,.(stoptime),summarize,meanDif = mean(diff,na.rm=TRUE),sdDiff=sd(diff,na.rm=TRUE))
View(avgDiff)
ggplot(avgDiff,aes(x=stoptime,y=diff))+geom_line()
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()
help(ggplot2)
help(facet)
avgDiff$month <- format(trips85$stoptime, "%m")
View(avgDiff)
table(is.na(trips85$stoptime))
avgDiff$month <- format(avgDiff$stoptime, "%m")
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()+facet(~ month)
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()+facet_wrap(~ month)
ggplot(avgDiff,aes(x=stoptime,y=meanDif,group=month))+geom_line()+facet_wrap(~ month)
avgDiff$day <- format(avgDiff$stoptime, "%d")
avgDiff$time <- format(avgDiff$stoptime,"%H:%M")
View(avgDiff)
ggplot(avgDiff,aes(x=time,y=meanDif,color=month))+geom_line()+facet_wrap(~ day)
ggplot(avgDiff,aes(x=time,y=meanDif,color=day))+geom_line()+facet_wrap(~ month)
ggplot(avgDiff,aes(x=time,y=meanDif))+geom_line()+facet_wrap(~ month)
avgDiff_June <- avgDiff[month==6,]
avgDiff_June <- avgDiff[avgDiff$month==6,]
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()
ggplot(avgDiff_June,aes(x=stoptime,y=meanDif))+geom_line()
View(avgDiff_June)
avgDiff_June <- avgDiff[avgDiff$month=="June",]
avgDiff_June <- avgDiff[avgDiff$month=="06",]
ggplot(avgDiff_June,aes(x=stoptime,y=meanDif))+geom_line()
help(format)
help(strptime)
trips85$month <- format(trips85$stoptime, "%m")
trips85$day <- format(trips85$stoptime, "%d")
trips85$day_str <- format(trips85$stoptime, "%a")
trips85$time <- format(trips85$stoptime,"%H:%M")
View(trips85)
avgDiff <- ddply(trips85,.(month,day_str,time),summarize,meanDif = mean(diff,na.rm=TRUE))
View(avgDiff)
avgDiff_June <- avgDiff[avgDiff$month=="06",]
avgDiff_June <- avgDiff[avgDiff$month=="07",]
ggplot(avgDiff_June,aes(x=time,y=meanDif))+geom_line()+facet_wrap(~ day)
ggplot(avgDiff_June,aes(x=time,y=meanDif))+geom_line()
ggplot(avgDiff_July,aes(x=time,y=meanDif,color=day))+geom_line()
avgDiff_July <- avgDiff[avgDiff$month=="07",]
ggplot(avgDiff_July,aes(x=time,y=meanDif,color=day))+geom_line()
ggplot(avgDiff_July,aes(x=time,y=meanDif,color=day_str))+geom_line()
ggplot(avgDiff_July,aes(x=time,y=meanDif))+geom_line()+facet_wrap(~ day_str)
View(avgDiff_July)
avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()+facet_wrap(~ day_str)
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()
View(avgDiff_July_Fri)
plot(avgDiff_July_Fri$time,avgDiff_July_Fri$meanDif)
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_point()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif,color=day))+geom_point()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif,color=day_str))+geom_point()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif,color=day_str))+geom_line()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif,color=factor(day_str)))+geom_line()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()
ggplot(avgDiff_July_Fri,aes(x=month,y=meanDif))+geom_line()
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()
trips85$time <- as.POSIXct(format(trips85$stoptime,"%H:%M"))
trips85$time <- as.POSIXct(strptime(trips85$stoptime,format="%H:%M"))
avgDiff <- ddply(trips85,.(month,day_str,time),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff_July_Fri,aes(x=time,y=meanDif))+geom_line()
trips85$time <- format(trips85$stoptime,"%H:%M")
trips85$time <- as.POSIXct(strptime(trips85$time,format="%H:%M"))
View(trips85)
trips85_July <- trips85[trips85$month=="07"]
trips85_July <- trips85[trips85$month=="07",]
avgDiff <- ddply(trips85,.(stoptime),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff <- ddply(trips85_July,.(stoptime),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()
avgDiff$day <- format(avgDiff$stoptime,"%d")
ggplot(avgDiff,aes(x=stoptime,y=meanDif,group=day))+geom_line()
ggplot(avgDiff,aes(x=stoptime,y=meanDif,color=day))+geom_line()
ggplot(avgDiff,aes(x=stoptime,y=meanDif,color=day))+geom_line()+facet_wrap(~ day)
avgDiff$day_str <- format(avgDiff$stoptime,"%a")
ggplot(avgDiff,aes(x=stoptime,y=meanDif,color=day_str))+geom_line()
ggplot(avgDiff,aes(x=stoptime,y=meanDif,color=day_str))+geom_line()+facet_wrap(~day_str)
trips85_July <- trips85[trips85$month=="07" & trips85$day=="04",]
avgDiff <- ddply(trips85_July,.(stoptime),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff$day <- format(avgDiff$stoptime,"%d")
avgDiff$day_str <- format(avgDiff$stoptime,"%a")
ggplot(avgDiff,aes(x=stoptime,y=meanDif))+geom_line()
trips85$hr <- format(trips85$stoptime,"%H")
avgDiff <- ddply(trips85_July,.(hr),summarize,meanDif = mean(diff,na.rm=TRUE))
trips85_July <- trips85[trips85$month=="07" & trips85$day=="04",]
avgDiff <- ddply(trips85_July,.(hr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff$day <- format(avgDiff$stoptime,"%d")
avgDiff$day_str <- format(avgDiff$stoptime,"%a")
##avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff,aes(x=hr,y=meanDif))+geom_line()
ggplot(avgDiff,aes(x=factor(hr),y=meanDif))+geom_line()
View(avgDiff)
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()
avgDiff <- ddply(trips85_July,.(day,hr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff$day <- format(avgDiff$stoptime,"%d")
avgDiff$day_str <- format(avgDiff$stoptime,"%a")
##avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()
trips85_July <- trips85[trips85$month=="07",]
avgDiff <- ddply(trips85_July,.(day,hr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiff$day <- format(avgDiff$stoptime,"%d")
avgDiff$day_str <- format(avgDiff$stoptime,"%a")
##avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~day)
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day)
View(avgDiff)
trips85$day <- format(trips85$stoptime, "%d")
View(trips85)
trips85_July <- trips85[trips85$month=="07",]
View(trips85_july)
View(trips85_July)
avgDiff <- ddply(trips85_July,.(day,hr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day)
avgDiff <- ddply(trips85_July,.(day_str,hr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day_str)
avgDiff <- ddply(trips85,.(day_str,hr),summarize,meanDif = mean(diff,na.rm=TRUE))
##avgDiff_July_Fri <- avgDiff[avgDiff$month=="07" & avgDiff$day=="Fri",]
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day_str)
getDateComponents <- function(vect){
print("Returns a separate dataframe that can be renamed and cbinded to input dataset")
month <- format(vect, "%m")
day <- format(vect, "%d")
day_str <- format(vect, "%a")
time <- format(vect$stoptime,"%H:%M")
time <- as.POSIXct(strptime(vect,format="%H:%M"))
hr <- format(vect,"%H")
df <- data.frame(month=month,day=day,day_str=day_str,time=time,hr=hr)
return(df)
}
View(getDateComponents(trips85$stoptime))
getDateComponents <- function(vect){
print("Returns a separate dataframe that can be renamed and cbinded to input dataset")
month <- format(vect, "%m")
day <- format(vect, "%d")
day_str <- format(vect, "%a")
time <- format(vect,"%H:%M")
time <- as.POSIXct(strptime(vect,format="%H:%M"))
hr <- format(vect,"%H")
df <- data.frame(month=month,day=day,day_str=day_str,time=time,hr=hr)
return(df)
}
View(getDateComponents(trips85$stoptime))
stoptimes <- getDateComponents(trips85$stoptime)
colnames(stoptimes) <- c("stopMonth","stopDay","stopDay_str","stopTime","stopHr")
View(colnames)
View(stoptimes)
trips85 <- cbind(trips85,stoptimes)
View(trips85)
starttimes <- getDateComponents(trips85$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85 <- cbind(trips85,stoptimes,starttimes)
trips85 <- trips %.%
filter(to_station_id==85)%.%
arrange(stoptime)
trips85$diff <- c(NA,diff(trips85$stoptime))
stoptimes <- getDateComponents(trips85$stoptime)
colnames(stoptimes) <- c("stopMonth","stopDay","stopDay_str","stopTime","stopHr")
starttimes <- getDateComponents(trips85$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85 <- cbind(trips85,stoptimes,starttimes)
avgDiff <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(hr),y=meanDif))+geom_line()+facet_wrap(~ day_str)+ggtitle("Latency of Bike Arrival at station 85")
colnames(trips85)
View(avgDiff)
ggplot(avgDiff,aes(x=as.integer(stopHr),y=meanDif))+geom_line()+facet_wrap(~ stopDay_str)+ggtitle("Latency of Bike Arrival at station 85")
avgDiff <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiff,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
avgDiffStop <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffStart <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
avgDiffStop$version <- "Stop"
avgDiffStart$version <- "Start"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
colnames(avgDiffStart)
avgDiffStart <- ddply(trips85,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
avgDiffStop <- ddply(trips85,.(stopDay_str,stopHr),summarize,meanDif = mean(diff,na.rm=TRUE))
colnames(avgDiffStop) <- c("Day_str","Hr","meanDif")
avgDiffStop$version <- "Stop"
colnames(avgDiffStart) <- c("Day_str","Hr","meanDif")
avgDiffStart$version <- "Start"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
avgDiffStop$version <- "Arrival"
avgDiffStart$version <- "Departure"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif,color=version))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
View(trips85)
trips85D <- trips %.%
filter(from_station_id==85)%.%
arrange(starttime)
trips85D$diff <- c(NA,diff(trips85D$stoptime))
starttimes <- getDateComponents(trips85D$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85D <- cbind(trips85D,starttimes)
avgDiffStart <- ddply(trips85D,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiffStart,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
trips85D$diff <- c(NA,diff(trips85D$starttime))
starttimes <- getDateComponents(trips85D$starttime)
colnames(starttimes) <- c("startMonth","startDay","startDay_str","startTime","startHr")
trips85D <- cbind(trips85D,starttimes)
avgDiffStart <- ddply(trips85D,.(startDay_str,startHr),summarize,meanDif = mean(diff,na.rm=TRUE))
ggplot(avgDiffStart,aes(x=as.integer(startHr),y=meanDif))+geom_line()+facet_wrap(~ startDay_str)+ggtitle("Latency of Bike Departure at station 85")
colnames(avgDiffStart) <- c("Day_str","Hr","meanDif")
avgDiffStart$version <- "Departure"
avgDiffCombo <- rbind(avgDiffStop,avgDiffStart)
ggplot(avgDiffCombo, aes(x=as.integer(Hr),y=meanDif,color=version))+geom_line()+facet_wrap(~ Day_str)+ggtitle("Latency of Bike Arrival and Departure")
trips <- trips %.%
arrange(to_station_id) %.%
arrange(tripstop)
colnames(trips)
trips <- trips %.%
arrange(to_station_id) %.%
arrange(stoptime)
View(trips)
trips <- trips %.%
arrange(to_station_id, stoptime)
View(trips)
testTrips <- ddply(trips,.(to_station_id),function(x) x$diff <- c(NA,diff(x$stoptime)))
testTrips <- ddply(trips,.(to_station_id),function(x) diff <- c(NA,diff(x$stoptime)))
testTrips <- ddply(trips,.(to_station_id),function(x) return(c(NA,diff(x$stoptime))))
fix <- function(x){
return(c(NA,diff(x$stoptime)))
}
testTrips <- ddply(trips,.(to_station_id),fix )
ddply(trips,.(to_station_id),fix )
fix <- function(x){
print(nrow(x))
return(c(NA,diff(x$stoptime)))
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
print(nrow(x))
diffs <- c(NA,diff(x$stoptime))
print(length(diffs))
return(diffs)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(diffs)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(x$diffs)
}
test <- ddply(trips,.(to_station_id),fix )
View(test)
fix <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(diffs)){print("ERROR")}
return(x)
}
test <- ddply(trips,.(to_station_id),fix )
fix <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
test <- ddply(trips,.(to_station_id),fix )
View(test)
doDiffsPanel <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
doDiffsPanel <- function(x){
x$diffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doDiffsPanel)
trips <- rename(trips, diffs="stopdiffs")
help(rename)
trips <- rename(trips, c(diffs="stopdiffs"))
colnames(trips)
doStopDiffsPanel <- function(x){
x$stopdiffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
doStartDiffsPanel <- function(x){
x$startdiffs <- c(NA,diff(x$starttime))
if(nrow(x)!=length(x$diffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
doStopDiffsPanel <- function(x){
x$stopdiffs <- c(NA,diff(x$stoptime))
if(nrow(x)!=length(x$stopdiffs)){print("ERROR")}
return(x)
}
doStartDiffsPanel <- function(x){
x$startdiffs <- c(NA,diff(x$starttime))
if(nrow(x)!=length(x$startdiffs)){print("ERROR")}
return(x)
}
trips <- ddply(trips,.(to_station_id),doStopDiffsPanel)
trips <- ddply(trips,.(from_station_id),doStartDiffsPanel)
View(trips)
trips <- trips %.%
arrange(from_station_id, starttime)
trips <- ddply(trips,.(from_station_id),doStartDiffsPanel)
View(trips)
avgStartDiffs_all <- ddply(trips,.(from_station_id),summarize,
meanStartDiff=mean(startdiffs,na.rm=TRUE),
sdStartDiff = sd(starddiffs,na.rm=TRUE))
avgStartDiffs_all <- ddply(trips,.(from_station_id),summarize,
meanStartDiff=mean(startdiffs,na.rm=TRUE),
sdStartDiff = sd(startdiffs,na.rm=TRUE))
avgDiffs_all <- merge(avgStartDiffs_all,avgStopDiffs_all,by.x="from_station_id",by.y="to_station_id",all=TRUE)
avgStopDiffs_all <- ddply(trips,.(to_station_id),summarize,
meanStopDiff=mean(stopdiffs,na.rm=TRUE),
sdStopDiff=sd(stopdiffs,na.rm=TRUE))
avgDiffs_all <- merge(avgStartDiffs_all,avgStopDiffs_all,by.x="from_station_id",by.y="to_station_id",all=TRUE)
View(avgDiffs_all)
avgDiffs_all$avgDiff <- (avgDiffs_all$meanStartDiff+avgDiffs_all$meanStopDiff)/2
avgDiffs_all <- arrange(avgDiffs_all,avgDiff)
View(avgDiffs_all)
colnames(avgDiffs_all)
avgDiffs_all <- merge(stations,avgDiffs_all,by.x="id",by.y="from_station_id",all=TRUE)
avgDiffs_all <- arrange(avgDiffs_all,avgDiff)
View(avgDiffs_all)
cor(avgDiffs_all$meanStartdiff,avgDiffs_all$meanStopDiff)
cor(as.numeric(avgDiffs_all$meanStartdiff),as.numeric(avgDiffs_all$meanStopDiff))
cor(as.numeric(avgDiffs_all$meanStartDiff),as.numeric(avgDiffs_all$meanStopDiff))
avgDiffs_all[1:10,]
avgDiffs_all[1:10,c(2,5,6,9:13)]
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)*5))
test <- data.frame(x=c(1,2,3,4,5,6))
test$y <- 1-test$x
test
test$z <- abs(test$y)
test
test$y <- 1/test$x
test
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)*5))
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)))
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(avgDiffs_all$avgDiff/max(avgDiffs_all$avgDiff)))
temp < 1/avgDiffs_all$avgDiff
temp <- 1/avgDiffs_all$avgDiff
View(temp)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/avgDiffs_all$avgDiff)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=1/avgDiffs_all$avgDiff)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=*1/avgDiffs_all$avgDiff)*2)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*2)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*2)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*5)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*20)
temp <- 1/avgDiffs_all$avgDiff
View(temp)
max(temp)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*1000)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=(1/avgDiffs_all$avgDiff)*10000)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier"),
latitude=c(41.7925006,41.8658049,41.8883247),
longitude=c(-87.5830209,-87.6329741,-87.6248812))
text(refPoints$longitude,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=2,col="red")
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier"),
latitude=c(41.7905733,41.8661567,41.8915194),
longitude=c(-87.5830607,-87.6170968,-87.6025343))
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=2,col="red")
text(refPoints$longitude,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.00001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.0001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude-.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude-.1,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.1,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.001,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
water <- makeLatLong("Waterways","Hydro")
plot(water,add=TRUE)
plot(water,add=TRUE,col="Blue")
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
refPoints <- data.frame(Location=c("MOHAI","FieldMuseum","NavyPier","WrigleyField"),
latitude=c(41.7905733,41.8661567,41.8915194,41.9478307),
longitude=c(-87.5830607,-87.6170968,-87.6025343,-87.6559023))
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.05,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(water,add=TRUE,col="Blue",border="blue")
plot(neighborhoods,add=TRUE,col=neighbCols)
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.02,y=refPoints$latitude,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude+.02,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.02,y=refPoints$latitude+.01,labels=refPoints$Location,cex=.5)
plot(city,xlim=c(-87.70786,-87.58071),ylim=c(41.78875,41.97835))
plot(neighborhoods,add=TRUE,col=neighbCols)
plot(water,add=TRUE,col="Blue",border="blue")
points(avgDiffs_all$longitude,avgDiffs_all$latitude,pch=20,cex=((1/avgDiffs_all$avgDiff)*1000)*2)
points(refPoints$longitude,y=refPoints$latitude,pch=20,cex=1,col="red")
text(refPoints$longitude+.02,y=refPoints$latitude+.01,labels=refPoints$Location,cex=.5)
text(refPoints$longitude+.01,y=refPoints$latitude+.005,labels=refPoints$Location,cex=.5)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
source('~/_RWork/Divvy/_Script-LargeImages.R', echo=TRUE)
